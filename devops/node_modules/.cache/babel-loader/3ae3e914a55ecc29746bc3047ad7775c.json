{"remainingRequest":"C:\\web\\vue-admin-template\\node_modules\\babel-loader\\lib\\index.js!C:\\web\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\web\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\web\\vue-admin-template\\src\\views\\podlog\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\web\\vue-admin-template\\src\\views\\podlog\\index.vue","mtime":1637662059483},{"path":"C:\\web\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\web\\vue-admin-template\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\web\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\web\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJDOi93ZWIvdnVlLWFkbWluLXRlbXBsYXRlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmcuanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgeyBwb2Rsb2cgfSBmcm9tICdAL2FwaS9wb2Rsb2cnOwppbXBvcnQgeyBnZXRfYWxsX25hbWVzcGFjZXMgfSBmcm9tICdAL2FwaS9rdWJlJzsKaW1wb3J0IHsgZ2V0X3BvZG5hbWVzIH0gZnJvbSAnQC9hcGkva3ViZSc7CmV4cG9ydCBkZWZhdWx0IHsKICBkZXN0cm95ZWQ6IGZ1bmN0aW9uIGRlc3Ryb3llZCgpIHsKICAgIGNvbnNvbGUubG9nKCJmdWNrICEhISEhISEhISEhISEhISEhISEhISEhISEhISIpOwogICAgdGhpcy5wb2QgPSAiIjsKICAgIHRoaXMuc2hvdyA9IG51bGw7CiAgICB0aGlzLmZpcnN0ID0gdHJ1ZTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGNob29zZV9uYW1lc3BhY2U6IGZ1bmN0aW9uIGNob29zZV9uYW1lc3BhY2UoKSB7CiAgICAgIHZhciBpdCA9IHRoaXM7CiAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ3NlbGVjdGVkX25hbWVzcGFjZScsIGl0Lm5hbWVzcGFjZSk7CiAgICAgIGdldF9wb2RuYW1lcyh7CiAgICAgICAgIm5hbWVzcGFjZSI6IHRoaXMubmFtZXNwYWNlCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgaXQucG9kcyA9IHJlc3BvbnNlLmRhdGEucG9kczsKICAgICAgICB2YXIgbG9ncyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsb2dzIik7CiAgICAgICAgY29uc29sZS5sb2coIiMjIyMjIyMjIyMjIyMjIyMjIik7CiAgICAgICAgY29uc29sZS5sb2coaXQuZmlyc3QpOwogICAgICAgIGNvbnNvbGUubG9nKCIjIyMjIyMjIyMjIyMjIyMjIyIpOwoKICAgICAgICBpZiAoaXQuZmlyc3QpIHsKICAgICAgICAgIGl0LmNob29zZV9wb2QoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaXQucG9kID0gIiI7CiAgICAgICAgICBpdC5zaG93ID0gZmFsc2U7CiAgICAgICAgICBsb2dzLnRleHRDb250ZW50ID0gIiI7CiAgICAgICAgfQoKICAgICAgICBpdC5maXJzdCA9IGZhbHNlOwogICAgICB9KTsKICAgIH0sCiAgICBjaG9vc2VfcG9kOiBmdW5jdGlvbiBjaG9vc2VfcG9kKCkgewogICAgICB2YXIgaXQgPSB0aGlzOwogICAgICBpdC5zaG93ID0gZmFsc2U7CiAgICAgIGxvZ3MudGV4dENvbnRlbnQgPSAiIjsKICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgnc2VsZWN0ZWRfcG9kJywgaXQucG9kKTsKICAgICAgdGhpcy5wb2ROYW1lID0gdGhpcy5wb2Q7CiAgICAgIHRoaXMubmFtZXNwYWNlID0gdGhpcy5uYW1lc3BhY2U7CiAgICAgIHRoaXMucmFuZElEID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc2xpY2UoLTYpOwogICAgICBwb2Rsb2coewogICAgICAgIG5hbWVzcGFjZTogaXQubmFtZXNwYWNlLAogICAgICAgIHBvZE5hbWU6IGl0LnBvZE5hbWUsCiAgICAgICAgcmFuZElEOiBpdC5yYW5kSUQKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZS5kYXRhKTsKICAgICAgfSk7CiAgICAgIHZhciByYW5kU2lkID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc2xpY2UoLTYpOwogICAgICB2YXIgdXJsID0gIndzOi8vMTkyLjE2OC4yLjIyMTo1Njc4LyIgKyB0aGlzLm5hbWVzcGFjZSArICJfIiArIHRoaXMucG9kTmFtZSArICJfIiArIHRoaXMucmFuZElEICsgIl8iICsgcmFuZFNpZDsKICAgICAgdmFyIHdzID0gbmV3IFdlYlNvY2tldCh1cmwpOwogICAgICBpdC5zaG93ID0gdHJ1ZTsKCiAgICAgIHdzLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIGlmIChpdC5zaG93IHx8IGl0LnBvZCAhPSAiIikgewogICAgICAgICAgdmFyIGVudHJ5OwogICAgICAgICAgdmFyIGxvZ3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibG9ncyIpOwogICAgICAgICAgZW50cnkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7CiAgICAgICAgICBlbnRyeS50ZXh0Q29udGVudCA9IGV2ZW50LmRhdGE7CiAgICAgICAgICBsb2dzLmFwcGVuZENoaWxkKGVudHJ5KTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgY29uc29sZS5sb2coImhhcHB5QEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAiKTsKICAgIHZhciBpdCA9IHRoaXM7CiAgICBnZXRfYWxsX25hbWVzcGFjZXMoKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICBpdC5uYW1lc3BhY2VzID0gcmVzcG9uc2UuZGF0YS5uYW1lc3BhY2VzOwogICAgICBjb25zb2xlLmxvZyhpdC5uYW1lc3BhY2VzKTsKICAgIH0pOwogICAgdmFyIHNlbGVjdGVkX25hbWVzcGFjZSA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oInNlbGVjdGVkX25hbWVzcGFjZSIpOwogICAgdmFyIHNlbGVjdGVkX3BvZCA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oInNlbGVjdGVkX3BvZCIpOwoKICAgIGlmIChzZWxlY3RlZF9uYW1lc3BhY2UpIHsKICAgICAgaXQubmFtZXNwYWNlID0gc2VsZWN0ZWRfbmFtZXNwYWNlOwogICAgICB0aGlzLmNob29zZV9uYW1lc3BhY2UoKTsKICAgIH0KCiAgICBpZiAoc2VsZWN0ZWRfcG9kKSB7CiAgICAgIGl0LnBvZCA9IHNlbGVjdGVkX3BvZDsKICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICB2YXIgX3JlZjsKCiAgICByZXR1cm4gX3JlZiA9IHsKICAgICAgZmlyc3Q6IHRydWUsCiAgICAgIG5hbWVzcGFjZTogIiIsCiAgICAgIG5hbWVzcGFjZXM6IFtdLAogICAgICBwb2Q6ICIiLAogICAgICBwb2RzOiBbXSwKICAgICAgbXNnOiAnJwogICAgfSwgX2RlZmluZVByb3BlcnR5KF9yZWYsICJuYW1lc3BhY2UiLCAnJyksIF9kZWZpbmVQcm9wZXJ0eShfcmVmLCAicG9kTmFtZSIsICcnKSwgX2RlZmluZVByb3BlcnR5KF9yZWYsICJyYW5kSUQiLCAnJyksIF9kZWZpbmVQcm9wZXJ0eShfcmVmLCAic2hvdyIsIGZhbHNlKSwgX3JlZjsKICB9Cn07"},{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div >\n\n  <el-select v-model=\"namespace\" placeholder=\"请先选择环境\" v-on:change=\"choose_namespace\">\n    <el-option\n      v-for=\"item in namespaces\"\n      :key=\"item.value\"\n      :label=\"item.label\"\n      :value=\"item.value\">\n    </el-option>\n  </el-select>\n  <el-select v-model=\"pod\" placeholder=\"请选择pod\" v-on:change=\"choose_pod\">\n    <el-option\n      v-for=\"item in pods\"\n      :key=\"item.value\"\n      :label=\"item.label\"\n      :value=\"item.value\">\n    </el-option>\n  </el-select>\n\r\n    <div id=\"logs\" style=\" overflow-y: auto; background:#3f3f3f; color:#009000; font-size: 12px ; width: 1500px; height: 700px;\">\n\n    </div>\n\r\n  </div>\r\n</template>\r\n\r\n<script>\nimport { podlog } from '@/api/podlog'\nimport { get_all_namespaces } from '@/api/kube'\nimport { get_podnames } from '@/api/kube'\n  export default {\n    destroyed(){\n      console.log(\"fuck !!!!!!!!!!!!!!!!!!!!!!!!!!!\")\n      this.pod=\"\"\n      this.show= null\n      this.first= true\n    },\n    methods:{\n      choose_namespace(){\n        let it = this\n        sessionStorage.setItem('selected_namespace', it.namespace)\n        get_podnames({\"namespace\": this.namespace}).then(function (response) {\n          it.pods = response.data.pods\n          var logs = document.getElementById(\"logs\")\n          console.log(\"#################\")\n          console.log(it.first)\n          console.log(\"#################\")\n          if (it.first){\n           it.choose_pod()\n          }else{\n            it.pod=\"\"\n            it.show= false\n            logs.textContent=\"\"\n          }\n          it.first = false\n        })\n      },\n      choose_pod(){\n          \t\tlet it = this\n               it.show= false\n               logs.textContent=\"\"\n               sessionStorage.setItem('selected_pod', it.pod)\n          \t\tthis.podName = this.pod\n          \t\tthis.namespace = this.namespace\n          \t\tthis.randID = Math.random().toString(36).slice(-6);\n          \t\tpodlog({namespace: it.namespace , podName: it.podName, randID:it.randID})\n          \t\t.then(response => {\n          \t\t\tconsole.log(response.data)\n          \t\t})\n          \t\tlet randSid = Math.random().toString(36).slice(-6);\n          \t\tlet url = \"ws://192.168.2.221:5678/\" + this.namespace +\"_\" + this.podName + \"_\"+ this.randID  +\"_\" + randSid\n          \t\tlet ws = new WebSocket(url)\n              it.show = true\n          \t\tws.onmessage = function(event) {\n                if (it.show || it.pod != \"\"){\n                  var entry\n                  var logs = document.getElementById(\"logs\")\n                  entry =document.createElement('p')\n                  entry.textContent= event.data\n                  logs.appendChild(entry)\n                }\n          \t\t}\n\n      }\n    },\n  \tmounted(){\n      console.log(\"happy@@@@@@@@@@@@@@@@@@@@@@@@@@\")\n      let it = this\n      get_all_namespaces().then(function (response) {\n        it.namespaces = response.data.namespaces\n        console.log(it.namespaces)\n  \t})\n\n    let selected_namespace = sessionStorage.getItem(\"selected_namespace\")\n\n    let selected_pod = sessionStorage.getItem(\"selected_pod\")\n    if (selected_namespace) {\n      it.namespace = selected_namespace\n       this.choose_namespace()\n    }\n    if (selected_pod) {\n      it.pod = selected_pod\n    }\n\n\n    },\n\n  \tdata(){\n  \t\treturn {\n        first: true,\n        namespace: \"\",\n        namespaces:[],\n        pod: \"\",\n        pods: [],\n        msg:  '',\n        namespace: '',\n        podName: '',\n        randID:'',\n        show: false\n  \t\t}\n  \t}\n\n  }\n\n\r\n</script>\r\n\r\n<style scoped>\r\n.line{\r\n  text-align: center;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/views/podlog"}]}